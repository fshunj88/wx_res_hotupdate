{"version":3,"sources":["Entry.js"],"names":["cc","Class","extends","Component","properties","openDebug","RichDebug","showDebug","closeDebug","hideDebug","onLoad","window","loadSubpackage","pkgName","callback","sys","platform","WECHAT_GAME","wx","console","log","loadTask","name","success","res","fail","error","onProgressUpdate","progress","totalBytesWritten","totalBytesExpectedToWrite","os","OS_ANDROID","OS_IOS","isBrowser","require","start","update","dt","onDestroy"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY,EAHP;;AAOLC,eAAW,qBAAY;AACnBC,kBAAUC,SAAV;AACH,KATI;;AAWLC,gBAAY,sBAAY;AACpBF,kBAAUG,SAAV;AACH,KAbI;;AAeLC,UAfK,oBAeI;AACL,YAAI,CAACC,OAAO,WAAP,CAAL,EAA0B;AACtBA,mBAAO,WAAP,IAAsB,EAAtB;AACH;AACD;AACA,YAAIC,iBAAiB,SAAjBA,cAAiB,CAAUC,OAAV,EAAmBC,QAAnB,EAA6B;AAC9C,gBAAId,GAAGe,GAAH,CAAOC,QAAP,IAAmBhB,GAAGe,GAAH,CAAOE,WAA1B,IAAyCC,EAAzC,IAA+CA,GAAGN,cAAtD,EAAsE;AAClEO,wBAAQC,GAAR,CAAY,0BAAZ;AACA,oBAAMC,WAAWH,GAAGN,cAAH,CAAkB;AAC/BU,0BAAMT,OADyB;AAE/BU,6BAAS,iBAAUC,GAAV,EAAe;AACpB,4BAAIV,QAAJ,EAAc;AACVA;AACH;AACJ,qBAN8B;AAO/BW,0BAAM,cAAUD,GAAV,EAAe;AACjBL,gCAAQO,KAAR,CAAcF,GAAd;AACH;AAT8B,iBAAlB,CAAjB;AAWAH,yBAASM,gBAAT,CAA0B,eAAO;AAC7BR,4BAAQC,GAAR,CAAY,MAAZ,EAAoBP,OAApB,EAA6BW,IAAII,QAAjC;AACAT,4BAAQC,GAAR,CAAY,WAAZ,EAAyBP,OAAzB,EAAkCW,IAAIK,iBAAtC;AACAV,4BAAQC,GAAR,CAAY,cAAZ,EAA4BP,OAA5B,EAAqCW,IAAIM,yBAAzC;AACH,iBAJD;AAKH,aAlBD,MAkBO,IAAI,CAAC9B,GAAGe,GAAH,CAAOgB,EAAP,IAAa/B,GAAGe,GAAH,CAAOiB,UAApB,IAAkChC,GAAGe,GAAH,CAAOgB,EAAP,IAAa/B,GAAGe,GAAH,CAAOkB,MAAvD,KAAkEjC,GAAGe,GAAH,CAAOC,QAAP,IAAmBhB,GAAGe,GAAH,CAAOmB,SAAhG,EAA2G;AAC9G;AACAvB,uBAAOwB,OAAP,CAAe,iBAAiBtB,OAAjB,GAA2B,WAA1C;AACA,oBAAIC,QAAJ,EAAc;AACVA;AACH;AACJ,aANM,MAOF;AACD;AACA,oBAAIA,QAAJ,EAAc;AACVA;AACH;AACJ;AACJ,SAhCD;;AAkCAF,uBAAe,WAAf,EAA4B,YAAY;AACpCO,oBAAQC,GAAR,CAAY,MAAZ;AACAT,mBAAO,WAAP,EAAoB,OAApB;AACH,SAHD;AAIH,KA1DI;AA4DLyB,SA5DK,mBA4DG;AACJ,YAAIzB,OAAO,WAAP,KAAuBA,OAAO,WAAP,EAAoB,OAApB,CAA3B,EAAyD;AACrDA,mBAAO,WAAP,EAAoB,OAApB;AACH;AACJ,KAhEI;AAkEL0B,UAlEK,kBAkEEC,EAlEF,EAkEM;AACP,YAAI3B,OAAO,WAAP,KAAuBA,OAAO,WAAP,EAAoB,QAApB,CAA3B,EAA0D;AACtDA,mBAAO,WAAP,EAAoB,QAApB,EAA8B2B,EAA9B;AACH;AACJ,KAtEI;AAwELC,aAxEK,uBAwEO;AACR,YAAI5B,OAAO,WAAP,KAAuBA,OAAO,WAAP,EAAoB,SAApB,CAA3B,EAA2D;AACvDA,mBAAO,WAAP,EAAoB,SAApB;AACH;AACJ;AA5EI,CAAT","file":"Entry.js","sourceRoot":"../../../../assets/Script","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n    },\r\n\r\n    openDebug: function () {\r\n        RichDebug.showDebug()\r\n    },\r\n\r\n    closeDebug: function () {\r\n        RichDebug.hideDebug()\r\n    },\r\n\r\n    onLoad() {\r\n        if (!window[\"GameLogic\"]) {\r\n            window[\"GameLogic\"] = {};\r\n        }\r\n        //加载分包\r\n        var loadSubpackage = function (pkgName, callback) {\r\n            if (cc.sys.platform == cc.sys.WECHAT_GAME && wx && wx.loadSubpackage) {\r\n                console.log(\"微信小游戏加载分包并执行GameLogic.js\");\r\n                const loadTask = wx.loadSubpackage({\r\n                    name: pkgName,\r\n                    success: function (res) {\r\n                        if (callback) {\r\n                            callback();\r\n                        }\r\n                    },\r\n                    fail: function (res) {\r\n                        console.error(res);\r\n                    }\r\n                });\r\n                loadTask.onProgressUpdate(res => {\r\n                    console.log('下载进度', pkgName, res.progress)\r\n                    console.log('已经下载的数据长度', pkgName, res.totalBytesWritten)\r\n                    console.log('预期需要下载的数据总长度', pkgName, res.totalBytesExpectedToWrite)\r\n                });\r\n            } else if ((cc.sys.os == cc.sys.OS_ANDROID || cc.sys.os == cc.sys.OS_IOS) && cc.sys.platform != cc.sys.isBrowser) {\r\n                //原生平台,进入ts层执行\r\n                window.require('subpackages/' + pkgName + \"/index.js\");\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }\r\n            else {\r\n                //H5平台不用管，自动执行ts层代码\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n            }\r\n        }\r\n\r\n        loadSubpackage(\"GameLogic\", function () {\r\n            console.log(\"载入完成\");\r\n            window[\"GameLogic\"][\"entry\"]();\r\n        });\r\n    },\r\n\r\n    start() {\r\n        if (window[\"GameLogic\"] && window[\"GameLogic\"][\"start\"]) {\r\n            window[\"GameLogic\"][\"start\"]();\r\n        }\r\n    },\r\n\r\n    update(dt) {\r\n        if (window[\"GameLogic\"] && window[\"GameLogic\"][\"update\"]) {\r\n            window[\"GameLogic\"][\"update\"](dt);\r\n        }\r\n    },\r\n\r\n    onDestroy() {\r\n        if (window[\"GameLogic\"] && window[\"GameLogic\"][\"destroy\"]) {\r\n            window[\"GameLogic\"][\"destroy\"]();\r\n        }\r\n    },\r\n\r\n});\r\n"]}